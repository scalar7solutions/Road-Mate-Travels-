import{j as s,v as o,b as d,e as x,t as c,a as p,s as w,I as b,J as y,q as u,x as k,K as m,w as z,o as n,H as g,T as _}from"./app-CO-Li67X.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";const I={name:"MultiSelect",emits:["update:modelValue","change"],props:{id:{type:String,required:!0},label:{type:String,default:""},placeholder:{type:String,default:"Pick items"},options:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},error:{type:String,default:""},wrapperClass:{type:String,default:"w-full"},valueKey:{type:String,default:"id"},labelKey:{type:String,default:"name"},maxSelected:{type:Number,default:1/0},imageKey:{type:String,default:""}},data(){return{open:!1,query:"",activeIndex:0}},computed:{getVal(){return t=>t?.[this.valueKey]??t?.value??t},getLbl(){return t=>t?.[this.labelKey]??t?.label??t?.title??String(t)},getImg(){return t=>this.imageKey?t?.[this.imageKey]??null:null},selectedOptions(){const t=new Set(this.modelValue??[]);return(this.options||[]).filter(e=>t.has(this.getVal(e)))},filtered(){const t=(this.query||"").trim().toLowerCase(),e=this.options||[];return t?e.filter(i=>this.getLbl(i).toLowerCase().includes(t)):e},headerText(){return this.selectedOptions.length?"Selected":this.query.trim()?"Results":this.label||"Options"}},watch:{open(t){t?(this.$nextTick(()=>this.$refs.input?.focus()),document.addEventListener("pointerdown",this.onOutside,{capture:!0})):document.removeEventListener("pointerdown",this.onOutside,{capture:!0})}},methods:{focusInput(){this.$refs.input?.focus()},onOutside(t){this.$refs.root?.contains(t.target)||this.close()},close(){this.open=!1,this.activeIndex=0},isSelected(t){return(this.modelValue||[]).includes(t)},move(t){this.open||(this.open=!0);const e=this.filtered.length;e&&(this.activeIndex=(this.activeIndex+t+e)%e)},selectActive(){const t=this.filtered[this.activeIndex];t&&this.toggle(t)},onBackspace(){if((this.query||"").trim())return;const t=this.modelValue||[];t.length&&this.remove(t[t.length-1])},toggle(t){if(this.disabled)return;const e=this.getVal(t),i=new Set(this.modelValue||[]);if(i.has(e))i.delete(e);else{if((this.modelValue?.length||0)>=this.maxSelected)return;i.add(e)}const f=Array.from(i);this.$emit("update:modelValue",f),this.$emit("change",f),this.query="",this.activeIndex=0,this.$nextTick(()=>this.$refs.input?.focus())},remove(t){const e=(this.modelValue||[]).filter(i=>i!==t);this.$emit("update:modelValue",e),this.$emit("change",e)}},beforeUnmount(){document.removeEventListener("pointerdown",this.onOutside,{capture:!0})}},S=["for"],L={key:0,class:"hover"},C=["id"],q={class:"flex flex-wrap items-center gap-1.5 px-2.5 py-1.5"},K=["onClick","title"],M={key:0,class:"mr-1 h-4 w-4 rounded-full overflow-hidden border border-white/50"},B=["src"],O=["placeholder","disabled"],T={key:0,class:"absolute z-30 mt-1 max-h-64 w-full overflow-auto rounded-md border border-zinc-200 bg-white shadow-lg dark:border-zinc-700 dark:bg-zinc-900"},N={class:"sticky top-0 bg-zinc-50 px-3 py-2 text-xs font-semibold text-zinc-700 dark:bg-zinc-800 dark:text-zinc-200"},A={class:"divide-y divide-zinc-100 dark:divide-zinc-800",role:"listbox","aria-multiselectable":"true"},j=["id","aria-selected","onClick","onMouseenter"],E={class:"flex items-center gap-2"},D={class:"h-5 w-5 rounded-full overflow-hidden border border-zinc-200 bg-zinc-50 flex items-center justify-center"},R=["src"],U={key:0,class:"px-3 py-3 text-sm text-zinc-500"},F={key:1,class:"mt-1 text-sm text-rose-600"};function H(t,e,i,f,a,r){return n(),s("div",{class:g(["w-full",i.wrapperClass]),ref:"root"},[i.label?(n(),s("label",{key:0,for:i.id,class:"mb-1 block text-sm font-medium text-zinc-700 dark:text-zinc-200"},[x(c(i.label)+" ",1),i.required?(n(),s("sup",L,"*")):o("",!0)],8,S)):o("",!0),d("div",{id:i.id,class:g(["relative rounded-md border bg-white dark:bg-zinc-900",[i.disabled?"cursor-not-allowed opacity-60":"cursor-text",i.error?"border-rose-500 focus-within:ring-rose-500":"border-zinc-300 dark:border-zinc-700","focus-within:ring-2"]]),onMousedown:e[7]||(e[7]=u((...l)=>r.focusInput&&r.focusInput(...l),["prevent"])),onClick:e[8]||(e[8]=l=>a.open=!0)},[d("div",q,[(n(!0),s(b,null,y(r.selectedOptions,(l,h)=>(n(),s("button",{key:r.getVal(l)+"-chip",type:"button",class:"inline-flex items-center rounded-full bg-rose-100 px-2 py-0.5 text-xs font-medium text-rose-500 ring-1 ring-emerald-600/20 ring-inset dark:bg-emerald-900/20 dark:text-emerald-200",onClick:u(v=>r.remove(r.getVal(l)),["stop"]),title:`Remove ${r.getLbl(l)}`},[r.getImg(l)?(n(),s("span",M,[d("img",{src:r.getImg(l),class:"h-full w-full object-cover"},null,8,B)])):o("",!0),x(" "+c(r.getLbl(l))+" ",1),e[9]||(e[9]=d("svg",{xmlns:"http://www.w3.org/2000/svg",class:"ml-1 h-3.5 w-3.5",viewBox:"0 0 20 20",fill:"currentColor"},[d("path",{"fill-rule":"evenodd",d:"M10 8.586l4.95-4.95 1.414 1.414L11.414 10l4.95 4.95-1.414 1.414L10 11.414l-4.95 4.95-1.414-1.414L8.586 10l-4.95-4.95L5.05 3.636 10 8.586z","clip-rule":"evenodd"})],-1))],8,K))),128)),w(d("input",{ref:"input",type:"text","onUpdate:modelValue":e[0]||(e[0]=l=>a.query=l),placeholder:r.selectedOptions.length?"":i.placeholder,disabled:i.disabled,class:"min-w-[6rem] flex-1 border-0 bg-transparent px-1 py-1 text-sm text-zinc-900 placeholder-zinc-400 outline-none dark:text-zinc-100",onKeydown:[e[1]||(e[1]=m(u(l=>r.move(1),["prevent"]),["down"])),e[2]||(e[2]=m(u(l=>r.move(-1),["prevent"]),["up"])),e[3]||(e[3]=m(u(l=>r.selectActive(),["prevent"]),["enter"])),e[4]||(e[4]=m(u((...l)=>r.close&&r.close(...l),["prevent"]),["esc"])),e[5]||(e[5]=m((...l)=>r.onBackspace&&r.onBackspace(...l),["delete"]))]},null,40,O),[[k,a.query]])]),p(_,{name:"fade",appear:""},{default:z(()=>[a.open?(n(),s("div",T,[d("div",N,c(r.headerText),1),d("ul",A,[(n(!0),s(b,null,y(r.filtered,(l,h)=>(n(),s("li",{key:r.getVal(l),id:`opt-${i.id}-${r.getVal(l)}`,role:"option","aria-selected":r.isSelected(r.getVal(l)),class:g(["cursor-pointer px-3 py-2 text-sm",[h===a.activeIndex?"custom-bg-primary text-white":"hover:bg-zinc-100 dark:hover:bg-zinc-800",r.isSelected(r.getVal(l))&&h!==a.activeIndex?"font-semibold text-zinc-800 dark:text-zinc-200":""]]),onMousedown:e[6]||(e[6]=u(()=>{},["prevent"])),onClick:v=>r.toggle(l),onMouseenter:v=>a.activeIndex=h},[d("div",E,[d("div",D,[r.getImg(l)?(n(),s("img",{key:0,src:r.getImg(l),class:"h-full w-full object-cover"},null,8,R)):o("",!0)]),d("span",null,c(r.getLbl(l)),1)])],42,j))),128)),r.filtered.length?o("",!0):(n(),s("li",U," No results "))])])):o("",!0)]),_:1})],42,C),i.error?(n(),s("p",F,c(i.error),1)):o("",!0)],2)}const G=V(I,[["render",H],["__scopeId","data-v-7b187bf2"]]);export{G as M};
