import{d as T,L as U,f as n,r as _,p as x,D as m,j as r,b as t,s as v,y as b,I as y,J as f,a as w,w as L,k,t as g,o as d}from"./app-CO-Li67X.js";import{D as M}from"./Datatable-V7WP3OY6.js";import{M as N}from"./MultiSelect-DJzAklNJ.js";const j={class:"rounded-2xl border border-neutral-200 bg-white p-4 shadow-sm space-y-4"},F={class:"flex flex-col gap-3 lg:flex-row lg:items-end lg:justify-between"},O={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 w-full lg:w-auto"},E=["value"],I=["value"],J=["value"],G=T({__name:"ProductList",setup(R){const s=U(),D=n(()=>s.props.categories||[]),i=n(()=>s.props.brands||[]),V=n(()=>s.props.colors||[]),C=n(()=>s.props.warranties||[]),a=_({category_id:null,brand_id:null,warranty_option_id:null,color_ids:[]}),K=n(()=>a.value.category_id?i.value.filter(o=>(o.category_ids||[]).includes(a.value.category_id)):i.value);x(()=>a.value.category_id,()=>{if(a.value.brand_id){const o=i.value.find(e=>e.id===a.value.brand_id);o&&!(o.category_ids||[]).includes(a.value.category_id)&&(a.value.brand_id=null)}});const S=n(()=>m("products.data",{category_id:a.value.category_id||void 0,brand_id:a.value.brand_id||void 0,warranty_option_id:a.value.warranty_option_id||void 0,color_ids:a.value.color_ids.length?a.value.color_ids.join(","):void 0})),u=_(0);x(a,()=>{u.value=Date.now()},{deep:!0});const h=[{data:"id",name:"id"},{data:"model",name:"model"},{data:"category_name",name:"category_id"},{data:"brand_name",name:"brand_id"},{data:"price_lkr",name:"price_lkr"},{data:"stock_badge",name:"in_stock",orderable:!1,searchable:!1},{data:"status_badge",name:"status",orderable:!1,searchable:!1},{data:"actions",name:"actions",orderable:!1,searchable:!1}],A=[{targets:[5,6,7],render:o=>o}];function B(o){const l=o.target.closest("button[data-action]");if(!l)return;o.preventDefault(),o.stopPropagation();const c=l.dataset.action,p=l.dataset.id,P=l.dataset.name;if(!(!c||!p)){if(c==="edit"){k.visit(m("products.edit",Number(p)));return}if(c==="delete"){if(!confirm(`Delete product "${P||""}"? This cannot be undone.`))return;k.delete(m("products.destroy",Number(p)),{preserveScroll:!0,onSuccess:()=>u.value=Date.now()})}}}return(o,e)=>(d(),r("div",j,[t("div",F,[e[11]||(e[11]=t("div",null,[t("div",{class:"font-semibold text-neutral-800"},"All Products"),t("p",{class:"text-sm text-neutral-500"},"Filter and manage your products.")],-1)),t("div",O,[t("div",null,[e[5]||(e[5]=t("label",{class:"block text-xs font-medium text-neutral-600 mb-1"},"Category",-1)),v(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>a.value.category_id=l),class:"w-full rounded-xl border border-neutral-200 px-3 py-2 text-sm outline-none focus:border-red-500"},[e[4]||(e[4]=t("option",{value:null},"All",-1)),(d(!0),r(y,null,f(D.value,l=>(d(),r("option",{key:l.id,value:l.id},g(l.name),9,E))),128))],512),[[b,a.value.category_id]])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-xs font-medium text-neutral-600 mb-1"},"Brand",-1)),v(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.brand_id=l),class:"w-full rounded-xl border border-neutral-200 px-3 py-2 text-sm outline-none focus:border-red-500"},[e[6]||(e[6]=t("option",{value:null},"All",-1)),(d(!0),r(y,null,f(K.value,l=>(d(),r("option",{key:l.id,value:l.id},g(l.name),9,I))),128))],512),[[b,a.value.brand_id]])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-xs font-medium text-neutral-600 mb-1"},"Warranty Type",-1)),v(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.warranty_option_id=l),class:"w-full rounded-xl border border-neutral-200 px-3 py-2 text-sm outline-none focus:border-red-500"},[e[8]||(e[8]=t("option",{value:null},"All",-1)),(d(!0),r(y,null,f(C.value,l=>(d(),r("option",{key:l.id,value:l.id},g(l.name),9,J))),128))],512),[[b,a.value.warranty_option_id]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-xs font-medium text-neutral-600 mb-1"},"Colors",-1)),w(N,{id:"filter_color_ids",label:"",placeholder:"All colors",options:V.value,modelValue:a.value.color_ids,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.color_ids=l),valueKey:"id",labelKey:"name",imageKey:"image_url"},null,8,["options","modelValue"])])])]),t("div",{onClick:B},[w(M,{id:"productsTable",url:S.value,columns:h,columnDefs:A,order:[[0,"desc"]],reloadKey:u.value},{header:L(()=>[...e[12]||(e[12]=[t("tr",null,[t("th",{style:{width:"60px"}},"#"),t("th",null,"Model"),t("th",null,"Category"),t("th",null,"Brand"),t("th",{style:{width:"120px"}},"Price (LKR)"),t("th",{style:{width:"120px"}},"Stock"),t("th",{style:{width:"120px"}},"Status"),t("th",{style:{width:"220px"}},"Actions")],-1)])]),_:1},8,["url","reloadKey"])])]))}});export{G as _};
